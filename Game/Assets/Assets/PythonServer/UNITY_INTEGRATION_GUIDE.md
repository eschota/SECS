# Unity Integration Guide

## üéÆ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Unity —Å –∏–≥—Ä–æ–≤—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **main.cs** - –ì–ª–∞–≤–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–≥—Ä—ã
2. **Lobby.cs** - –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –æ—á–µ—Ä–µ–¥–µ–π
3. **ui_lobby.cs** - UI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ª–æ–±–±–∏

### –ü–æ—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

```
Server Connection ‚Üí Player Registration ‚Üí Lobby ‚Üí Queue ‚Üí Match
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä–∞–º –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

1. `https://renderfin.com` (Production)
2. `https://localhost:7000` (Local Development)
3. `http://localhost:5000` (Local Development)

### Heartbeat —Å–∏—Å—Ç–µ–º–∞

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ heartbeat –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ç–∞–π–º–∞—É—Ç—ã

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∏–≥—Ä–æ–∫–∞

```csharp
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –æ—á–µ—Ä–µ–¥–∏
if (Lobby.Instance.CanJoinQueue()) {
    Lobby.Instance.AddPlayerToQueue();
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–∫–∏–Ω—É—Ç—å –æ—á–µ—Ä–µ–¥—å
if (Lobby.Instance.CanLeaveQueue()) {
    Lobby.Instance.RemovePlayerFromQueue();
}
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä–æ–∫–∞

- `Unregistered` - –ù–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
- `Registering` - –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è
- `Authenticating` - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `Idle` - –ì–æ—Ç–æ–≤ –∫ –∏–≥—Ä–µ
- `Searching` - –ü–æ–∏—Å–∫ –º–∞—Ç—á–∞
- `InGame` - –í –∏–≥—Ä–µ
- `Error` - –û—à–∏–±–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

**–í Editor:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –∞–∫–∫–∞—É–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å –∏–º–µ–Ω–µ–º `Developer account {GUID}`
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ PlayerPrefs

**–í WebGL:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –≥–æ—Å—Ç–µ–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç —Å –∏–º–µ–Ω–µ–º `Guest_{GUID}`
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ cookies (—Ç—Ä–µ–±—É–µ—Ç JavaScript –ø–ª–∞–≥–∏–Ω)

### API Endpoints

```
POST /api-game-player/                  # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
POST /api-game-player/heartbeat         # Heartbeat
POST /api-game-queue/{userId}/join      # –í–æ–π—Ç–∏ –≤ –æ—á–µ—Ä–µ–¥—å
POST /api-game-queue/{userId}/leave     # –ü–æ–∫–∏–Ω—É—Ç—å –æ—á–µ—Ä–µ–¥—å
GET  /api-game-queue/{userId}/status    # –°—Ç–∞—Ç—É—Å –æ—á–µ—Ä–µ–¥–∏
GET  /api-game-statistics/              # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ API
cd Assets/PythonServer
python test_unity_api.py
```

### –û—Ç–ª–∞–¥–∫–∞

- –í—Å–µ –ª–æ–≥–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `[Lobby]`, `[ui_lobby]`, `[main]`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Debug.Log –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- Debug.LogError –¥–ª—è –æ—à–∏–±–æ–∫
- Debug.LogWarning –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

### –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å** –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏–π
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
3. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** gracefully
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ heartbeat** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```csharp
// –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
var status = Lobby.Instance.GetPlayerStatus();

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π
if (Lobby.Instance.CanJoinQueue()) {
    // –ò–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –æ—á–µ—Ä–µ–¥–∏
}

// –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
var user = Lobby.Instance.currentUser;
Debug.Log($"Player: {user.nick_name} (ID: {user.user_id})");
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `main.cs`:

```csharp
public static string[] PossibleServers = {
    "https://your-production-server.com",
    "https://localhost:7000",
    "http://localhost:5000"
};
```

### Troubleshooting

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ SSL
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è BypassCertificate –¥–ª—è development builds

**–ü—Ä–æ–±–ª–µ–º–∞:** Heartbeat –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ user_id –∏ timestamp —Ñ–æ—Ä–º–∞—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –º–æ–∂–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –æ—á–µ—Ä–µ–¥–∏
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∏–≥—Ä–æ–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é

**–ü—Ä–æ–±–ª–µ–º–∞:** UI –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ RefreshUI() –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

---

## üéØ Production Ready

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Å —Å–ª–µ–¥—É—é—â–∏–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏:

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ Heartbeat —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∏–≥—Ä–æ–∫–∞
- ‚úÖ Graceful error handling
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ UI –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WebGL –∏ Editor

**–î–∞—Ç–∞:** 2025-01-10  
**–í–µ—Ä—Å–∏—è:** 1.0 