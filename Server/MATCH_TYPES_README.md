# üéØ SECS Match Types System - –°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤ –º–∞—Ç—á–µ–π

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ

### üéÆ Unity Client (–ò–≥—Ä–æ–∫)
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ò–≥—Ä–æ–∫ –º–æ–≥ –∏—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –º–∞—Ç—á–∏ 1v1
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –º–∞—Ç—á–∞ –≤ UI
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ò–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–∏–ø –º–∞—Ç—á–∞ (1v1, 2v2, 4-player FFA)

### ü§ñ Bots (–ë–æ—Ç—ã)
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- **–ü–æ–≤–µ–¥–µ–Ω–∏–µ**: –°–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞—é—Ç —Ç–∏–ø –º–∞—Ç—á–∞ –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –∏—Ö –ø–æ–≤–µ–¥–µ–Ω–∏—è
- **–¢–∏–ø—ã**: –ö–∞–∂–¥—ã–π –±–æ—Ç –º–æ–∂–µ—Ç –∏—Å–∫–∞—Ç—å –ª—é–±–æ–π —Ç–∏–ø –º–∞—Ç—á–∞ (1v1, 2v2, 4-player FFA)

### üñ•Ô∏è Server (–°–µ—Ä–≤–µ—Ä)
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- **–õ–æ–≥–∏–∫–∞**: –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ö–û–ù–ö–†–ï–¢–ù–´–ô —Ç–∏–ø –º–∞—Ç—á–∞ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–∏—Å–∫ —Å—Ç—Ä–æ–≥–æ –ø–æ —Ç–∏–ø–∞–º
- **–ú–∞—Ç—á–º–µ–π–∫–∏–Ω–≥**: –û—Ç–¥–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –º–∞—Ç—á–∞

## üîß –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### üóëÔ∏è –ü—Ä–æ–±–ª–µ–º–∞: –ú–∞—Ç—á–∏ –Ω–µ –æ—á–∏—â–∞–ª–∏—Å—å –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞
- **–ü—Ä–æ–±–ª–µ–º–∞**: –°—Ç–∞—Ä—ã–µ –º–∞—Ç—á–∏ –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: Unity –≤–∏–¥–µ–ª –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –º–∞—Ç—á–∏ –∫–∞–∫ –∞–∫—Ç–∏–≤–Ω—ã–µ
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ –º–∞—Ç—á–µ–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ `main.cs`

### üìä –ü—Ä–æ–±–ª–µ–º–∞: Unity –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª —Å—Ç–∞—Ç—É—Å –º–∞—Ç—á–∞
- **–ü—Ä–æ–±–ª–µ–º–∞**: Unity –ø—Ä–æ–≤–µ—Ä—è–ª —Ç–æ–ª—å–∫–æ `matchId > 0`, –∏–≥–Ω–æ—Ä–∏—Ä—É—è —Å—Ç–∞—Ç—É—Å –º–∞—Ç—á–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –º–∞—Ç—á–∏
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `gameMatch.status == 0` (—Ç–æ–ª—å–∫–æ InProgress)

### üîó –ü—Ä–æ–±–ª–µ–º–∞: –≠–Ω–¥–ø–æ–∏–Ω—Ç –≤–æ–∑–≤—Ä–∞—â–∞–ª –≤—Å–µ –º–∞—Ç—á–∏
- **–ü—Ä–æ–±–ª–µ–º–∞**: `/api-game-match/user/{userId}` –≤–æ–∑–≤—Ä–∞—â–∞–ª –≤—Å–µ –º–∞—Ç—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: Unity –≤–∏–¥–µ–ª –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –º–∞—Ç—á–∏ –∫–∞–∫ –∞–∫—Ç–∏–≤–Ω—ã–µ
- **–†–µ—à–µ–Ω–∏–µ**: –≠–Ω–¥–ø–æ–∏–Ω—Ç —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏

## üéØ –¢–∏–ø—ã –º–∞—Ç—á–µ–π

| –¢–∏–ø | –ö–æ–¥ | –ù–∞–∑–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|-----|----------|---------|----------|
| 1v1 | 1 | OneVsOne | 0 = InProgress | –û–¥–∏–Ω –ø—Ä–æ—Ç–∏–≤ –æ–¥–Ω–æ–≥–æ |
| 2v2 | 2 | TwoVsTwo | 1 = Completed | –î–≤–∞ –ø—Ä–æ—Ç–∏–≤ –¥–≤—É—Ö |
| FFA | 4 | FourPlayerFFA | 2 = Cancelled | –ß–µ—Ç—ã—Ä–µ –∏–≥—Ä–æ–∫–∞ (–∫–∞–∂–¥—ã–π —Å–∞–º –∑–∞ —Å–µ–±—è) |

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
```bash
# –û–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫
start_server_with_bots.bat

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –æ—á–∏—Å—Ç–∫–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π)
restart_server_with_cleanup.bat
```

### 2. Unity Client
```csharp
// –ò–≥—Ä–æ–∫ –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∏–ø –º–∞—Ç—á–∞ —á–µ—Ä–µ–∑ UI –∫–Ω–æ–ø–∫–∏:
button_1v1.onClick -> SelectMatchType(1)
button_2v2.onClick -> SelectMatchType(2) 
button_4ffa.onClick -> SelectMatchType(4)

// –ó–∞—Ç–µ–º –Ω–∞–∂–∏–º–∞–µ—Ç Play Now:
Lobby.Instance.AddPlayerToQueue(selectedMatchType)

// Unity –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏:
bool hasActiveMatch = gameMatch.matchId > 0 && gameMatch.status == 0;
```

### 3. Bots
```python
# –ë–æ—Ç—ã —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞—é—Ç —Ç–∏–ø –º–∞—Ç—á–∞:
match_type = random.choice(settings["match_types"])
self.join_queue(bot_id, bot_data, match_type)
```

### 4. Server API
```json
POST /api-game-queue/{userId}/join
{
    "MatchType": 1  // 1, 2, or 4
}

GET /api-game-match/user/{userId}
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏ (status == 0)

GET /api-game-match/user/{userId}/history
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –º–∞—Ç—á–µ–π
```

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
test_match_types.bat  # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ê–¥–º–∏–Ω–∫–∞**: https://renderfin.com/online-game/admin.html
- **–ò–≥—Ä–∞**: https://renderfin.com/online-game/game.html
- **API**: https://renderfin.com/api-game-queue/stats

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
```csharp
// main.cs - CleanupInactivePlayersOnStartup()
// 1. –û—Ç–º–µ–Ω—è–µ–º –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏
var activeMatches = await context.GameMatches
    .Where(m => m.Status == GameMatchStatus.InProgress)
    .ToListAsync();

// 2. –û—á–∏—â–∞–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ –º–∞—Ç—á–∏ —É –∏–≥—Ä–æ–∫–æ–≤
var playersInMatches = await context.Users
    .Where(u => u.CurrentMatchId != null)
    .ToListAsync();

// 3. –û—á–∏—â–∞–µ–º –æ—á–µ—Ä–µ–¥—å
var allQueueEntries = await context.MatchQueues.ToListAsync();
```

### Unity –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```csharp
// Lobby.cs - CheckPlayerMatchStatus()
var gameMatch = JsonUtility.FromJson<GameMatchResponse>(cleanData);

// –ö–†–ò–¢–ò–ß–ù–û: –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –º–∞—Ç—á–∞
bool hasActiveMatch = gameMatch.matchId > 0 && gameMatch.status == 0;

if (hasActiveMatch) {
    // –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∞–∫—Ç–∏–≤–Ω—ã–π –º–∞—Ç—á
    _playerStatus = PlayerStatus.InGame;
    SceneManager.LoadScene("GameScene");
} else {
    // –ú–∞—Ç—á –∑–∞–≤–µ—Ä—à—ë–Ω - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –ª–æ–±–±–∏
    _playerStatus = PlayerStatus.Idle;
}
```

### Server —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
```csharp
// GameMatchController.cs
[HttpGet("user/{userId}")]
public async Task<ActionResult> GetUserMatches(int userId)
{
    // –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏
    var activeMatches = await _context.GameMatches
        .Where(m => m.Status == GameMatchStatus.InProgress)
        .ToListAsync();
    
    return Ok(activeMatches.Where(m => m.PlayersList.Contains(userId)));
}
```

## üéÆ –ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å

1. **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** ‚Üí –û—á–∏—â–∞–µ—Ç –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –º–∞—Ç—á–∏ –∏ —Å—Å—ã–ª–∫–∏
2. **–ò–≥—Ä–æ–∫** –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∏–ø –º–∞—Ç—á–∞ –≤ Unity UI
3. **–ë–æ—Ç** —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∏–ø –º–∞—Ç—á–∞
4. **–°–µ—Ä–≤–µ—Ä** –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–∏–ø –º–∞—Ç—á–∞
5. **–ú–∞—Ç—á–º–µ–π–∫–∏–Ω–≥** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–∏—Å–∫ —Å—Ç—Ä–æ–≥–æ –ø–æ —Ç–∏–ø–∞–º
6. **–ú–∞—Ç—á —Å–æ–∑–¥–∞–µ—Ç—Å—è** ‚Üí –°—Ç–∞—Ç—É—Å = InProgress (0)
7. **Unity –ø—Ä–æ–≤–µ—Ä—è–µ—Ç** ‚Üí –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏ (status == 0)
8. **–ü–µ—Ä–µ—Ö–æ–¥ –≤ –º–∞—Ç—á** ‚Üí –¢–æ–ª—å–∫–æ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º —Å—Ç–∞—Ç—É—Å–µ

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –û—á–µ—Ä–µ–¥—å
- `oneVsOne` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –≤ –æ—á–µ—Ä–µ–¥–∏ 1v1
- `twoVsTwo` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –≤ –æ—á–µ—Ä–µ–¥–∏ 2v2
- `fourPlayerFFA` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –≤ –æ—á–µ—Ä–µ–¥–∏ 4-player FFA

### –ú–∞—Ç—á–∏
- `OneVsOneMatches` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ç—á–µ–π 1v1
- `TwoVsTwoMatches` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ç—á–µ–π 2v2
- `FourPlayerFFAMatches` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ç—á–µ–π 4-player FFA

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–ò–≥—Ä–æ–∫**: –ú–æ–∂–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–∏–ø –º–∞—Ç—á–∞ —á–µ—Ä–µ–∑ UI  
‚úÖ **–ë–æ—Ç—ã**: –°–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞—é—Ç —Ç–∏–ø –º–∞—Ç—á–∞ –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è  
‚úÖ **–°–µ—Ä–≤–µ—Ä**: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–∏—Å–∫ —Å—Ç—Ä–æ–≥–æ –ø–æ —Ç–∏–ø–∞–º, –Ω–µ —Å–ª—É—á–∞–π–Ω–æ  
‚úÖ **–ú–∞—Ç—á–º–µ–π–∫–∏–Ω–≥**: –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –º–∞—Ç—á–µ–π  
‚úÖ **–û—á–∏—Å—Ç–∫–∞**: –ú–∞—Ç—á–∏ –æ—á–∏—â–∞—é—Ç—Å—è –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞  
‚úÖ **–°—Ç–∞—Ç—É—Å—ã**: Unity –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏  
‚úÖ **–ü–µ—Ä–µ—Ö–æ–¥—ã**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ –º–∞—Ç—á  

**–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã!** üéØ 