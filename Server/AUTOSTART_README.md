# RenderFin Server - ะกะธััะตะผะฐ ะะฒัะพะทะฐะฟััะบะฐ

## ะะฟะธัะฐะฝะธะต

ะกะธััะตะผะฐ ะฐะฒัะพะทะฐะฟััะบะฐ ะพะฑะตัะฟะตัะธะฒะฐะตั **24/7 ัะฐะฑะพัั ัะตัะฒะตัะฐ** ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผ ะทะฐะฟััะบะพะผ ะฟัะธ ััะฐััะต Windows ะธ ัะฐะผะพะฒะพัััะฐะฝะพะฒะปะตะฝะธะตะผ ะฟัะธ ัะฑะพัั.

### ะััะธัะตะบัััะฐ ัะธััะตะผั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    WINDOWS SCHEDULER                        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โ  โ              MASTER WATCHDOG                        โ    โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ    โ
โ  โ  โ            PRIMARY WATCHDOG                 โ    โ    โ
โ  โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ    โ    โ
โ  โ  โ  โ           .NET SERVER               โ    โ    โ    โ
โ  โ  โ  โ     (dotnet run)                    โ    โ    โ    โ
โ  โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ    โ    โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ    โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะฃัะพะฒะฝะธ ะทะฐัะธัั

1. **Windows Scheduler** - ะะฒัะพะทะฐะฟััะบ ะฟัะธ ััะฐััะต ัะธััะตะผั
2. **Master Watchdog** - ะะพะฝััะพะปะธััะตั Primary Watchdog
3. **Primary Watchdog** - ะะพะฝััะพะปะธััะตั .NET Server
4. **Health Checks** - ะัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ ัะตัะตะท HTTPS

---

## ะัััััะน ััะฐัั

### 1. ะฃััะฐะฝะพะฒะบะฐ ะฐะฒัะพะทะฐะฟััะบะฐ

```cmd
# ะะฐะฟัััะธัั ะบะฐะบ ะะดะผะธะฝะธัััะฐัะพั
install-autostart.bat
```

### 2. ะฃะฟัะฐะฒะปะตะฝะธะต ัะธััะตะผะพะน

```cmd
# ะะฝัะตัะฐะบัะธะฒะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต
control-system.bat
```

### 3. ะฃะดะฐะปะตะฝะธะต ะฐะฒัะพะทะฐะฟััะบะฐ

```cmd
# ะะฐะฟัััะธัั ะบะฐะบ ะะดะผะธะฝะธัััะฐัะพั  
remove-autostart.bat
```

---

## ะะพะดัะพะฑะฝะฐั ะธะฝััััะบัะธั

### ะฃััะฐะฝะพะฒะบะฐ

#### ะขัะตะฑะพะฒะฐะฝะธั
- Windows 10/11
- .NET 8.0 ะธะปะธ ะฒััะต
- PowerShell 5.0 ะธะปะธ ะฒััะต
- ะัะฐะฒะฐ ะฐะดะผะธะฝะธัััะฐัะพัะฐ

#### ะจะฐะณ 1: ะะพะดะณะพัะพะฒะบะฐ
1. ะฃะฑะตะดะธัะตัั, ััะพ ะฒัะต ัะฐะนะปั ะฝะฐัะพะดัััั ะฒ ะฟะฐะฟะบะต `C:\SECS\Server`
2. ะัะพะฒะตัััะต ะฝะฐะปะธัะธะต ัะฐะนะปะฐ `Server.csproj`
3. ะฃะฑะตะดะธัะตัั, ััะพ ัะตัะฒะตั ะทะฐะฟััะบะฐะตััั ัะตัะตะท `dotnet run`

#### ะจะฐะณ 2: ะฃััะฐะฝะพะฒะบะฐ
1. ะัะบัะพะนัะต PowerShell **ะบะฐะบ ะะดะผะธะฝะธัััะฐัะพั**
2. ะะตัะตะนะดะธัะต ะฒ ะฟะฐะฟะบั ะฟัะพะตะบัะฐ:
   ```cmd
   cd C:\SECS\Server
   ```
3. ะะฐะฟัััะธัะต ัััะฐะฝะพะฒะบั:
   ```cmd
   .\install-autostart.bat
   ```

#### ะจะฐะณ 3: ะัะพะฒะตัะบะฐ
ะกะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะพะฒะตัะธั ัััะฐะฝะพะฒะบั ะธ ะทะฐะฟัััะธั ัะตัั ัะตัะฒะตัะฐ.

---

## ะฃะฟัะฐะฒะปะตะฝะธะต ัะธััะตะผะพะน

### ะคะฐะนะปั ัะฟัะฐะฒะปะตะฝะธั

| ะคะฐะนะป | ะะฟะธัะฐะฝะธะต |
|------|----------|
| `install-autostart.bat` | ะฃััะฐะฝะพะฒะบะฐ ะฐะฒัะพะทะฐะฟััะบะฐ |
| `remove-autostart.bat` | ะฃะดะฐะปะตะฝะธะต ะฐะฒัะพะทะฐะฟััะบะฐ |
| `control-system.bat` | ะะฝัะตัะฐะบัะธะฒะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต |
| `master-watchdog.ps1` | ะะปะฐะฒะฝัะน ะบะพะฝััะพะปะปะตั |
| `server-watchdog-fixed.ps1` | ะัะฝะพะฒะฝะพะน ะฒะพััะดะพะณ |

### ะะฝัะตัะฐะบัะธะฒะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต

ะะฐะฟัััะธัะต `control-system.bat` ะดะปั ะดะพัััะฟะฐ ะบ ะผะตะฝั:

```
[1] Start System        - ะะฐะฟัััะธัั ัะธััะตะผั ะฒะพััะดะพะณะฐ
[2] Stop System         - ะััะฐะฝะพะฒะธัั ัะธััะตะผั ะฒะพััะดะพะณะฐ
[3] Check Status        - ะัะพะฒะตัะธัั ัะพััะพัะฝะธะต ัะธััะตะผั
[4] View Logs           - ะัะพัะผะพััะตัั ะปะพะณะธ
[5] Restart System      - ะะตัะตะทะฐะฟัััะธัั ัะธััะตะผั
[6] Enable Autostart    - ะะบะปััะธัั ะฐะฒัะพะทะฐะฟััะบ
[7] Disable Autostart   - ะัะบะปััะธัั ะฐะฒัะพะทะฐะฟััะบ
[8] Test Server         - ะัะพะฒะตัะธัั ัะฐะฑะพัั ัะตัะฒะตัะฐ
[9] Exit                - ะััะพะด
```

### ะััะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต ัะตัะตะท PowerShell

```powershell
# ะะฐะฟััะบ ัะธััะตะผั
Start-ScheduledTask -TaskName "RenderFin-Server-Watchdog"

# ะััะฐะฝะพะฒะบะฐ ัะธััะตะผั
Stop-ScheduledTask -TaskName "RenderFin-Server-Watchdog"

# ะัะพะฒะตัะบะฐ ัะพััะพัะฝะธั
Get-ScheduledTask -TaskName "RenderFin-Server-Watchdog"
Get-ScheduledTaskInfo -TaskName "RenderFin-Server-Watchdog"
```

---

## ะะพะฝะธัะพัะธะฝะณ ะธ ะปะพะณะธ

### ะะฐัะฟะพะปะพะถะตะฝะธะต ะปะพะณะพะฒ

```
C:\SECS\Code\
โโโ master-watchdog.log      # ะะปะฐะฒะฝัะน ะบะพะฝััะพะปะปะตั
โโโ watchdog.log            # ะัะฝะพะฒะฝะพะน ะฒะพััะดะพะณ
โโโ server-activity.log     # ะะบัะธะฒะฝะพััั ัะตัะฒะตัะฐ
โโโ matchmaking-activity.log # ะะฐััะผะตะนะบะธะฝะณ
โโโ unity-activity.log      # Unity ะบะปะธะตะฝั
```

### ะะพะฝะธัะพัะธะฝะณ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ

```powershell
# ะัะพัะผะพัั ะปะพะณะพะฒ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
Get-Content C:\SECS\Code\master-watchdog.log -Wait -Tail 10

# ะัะพะฒะตัะบะฐ ัะฐะฑะพัั ัะตัะฒะตัะฐ
Invoke-WebRequest -Uri "https://renderfin.com/api-game-queue/stats"
```

### ะะปััะตะฒัะต ะธะฝะดะธะบะฐัะพัั

| ะะพะณ | ะะฝะฐัะตะฝะธะต |
|-----|----------|
| `[MASTER] ===== MASTER WATCHDOG SERVICE STARTED =====` | ะกะธััะตะผะฐ ะทะฐะฟััะตะฝะฐ |
| `[OK] System healthy. Watchdog PID: XXXX` | ะัะต ัะฐะฑะพัะฐะตั ะฝะพัะผะฐะปัะฝะพ |
| `[RESTART] Attempting to restart primary watchdog...` | ะะตัะตะทะฐะฟััะบ ะฒะพััะดะพะณะฐ |
| `[ERROR] Primary watchdog is not healthy!` | ะัะพะฑะปะตะผะฐ ั ัะธััะตะผะพะน |

---

## ะะฐัััะพะนะบะฐ ะธ ะบะพะฝัะธะณััะฐัะธั

### ะะฐัะฐะผะตััั Master Watchdog

```powershell
# ะะฐะฟััะบ ั ะบะฐััะพะผะฝัะผะธ ะฟะฐัะฐะผะตััะฐะผะธ
.\master-watchdog.ps1 -CheckInterval 60 -MaxRestarts 20 -RestartCooldown 600
```

| ะะฐัะฐะผะตัั | ะะฟะธัะฐะฝะธะต | ะะพ ัะผะพะปัะฐะฝะธั |
|----------|----------|--------------|
| `CheckInterval` | ะะฝัะตัะฒะฐะป ะฟัะพะฒะตัะบะธ (ัะตะบ) | 30 |
| `MaxRestarts` | ะะฐะบัะธะผัะผ ะฟะตัะตะทะฐะฟััะบะพะฒ | 10 |
| `RestartCooldown` | ะะฐัะทะฐ ะผะตะถะดั ะฟะตัะตะทะฐะฟััะบะฐะผะธ (ัะตะบ) | 300 |

### ะะฐัะฐะผะตััั Primary Watchdog

```powershell
# ะะฐะฟััะบ ั ะผะพะฝะธัะพัะธะฝะณะพะผ ัะฐะนะปะพะฒ
.\server-watchdog-fixed.ps1 -CheckInterval 5 -MonitorFiles
```

| ะะฐัะฐะผะตัั | ะะฟะธัะฐะฝะธะต | ะะพ ัะผะพะปัะฐะฝะธั |
|----------|----------|--------------|
| `CheckInterval` | ะะฝัะตัะฒะฐะป ะฟัะพะฒะตัะบะธ (ัะตะบ) | 10 |
| `MonitorFiles` | ะะพะฝะธัะพัะธะฝะณ ะธะทะผะตะฝะตะฝะธะน ัะฐะนะปะพะฒ | false |

---

## ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะัะพะฑะปะตะผะฐ: ะกะธััะตะผะฐ ะฝะต ะทะฐะฟััะบะฐะตััั

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต ะฟัะฐะฒะฐ ะฐะดะผะธะฝะธัััะฐัะพัะฐ
2. ะฃะฑะตะดะธัะตัั, ััะพ .NET ัััะฐะฝะพะฒะปะตะฝ
3. ะัะพะฒะตัััะต ะฟััะธ ะบ ัะฐะนะปะฐะผ
4. ะะพัะผะพััะธัะต ะปะพะณะธ

```powershell
# ะัะพะฒะตัะบะฐ ะทะฐะดะฐัะธ
Get-ScheduledTask -TaskName "RenderFin-Server-Watchdog"

# ะัะพะฒะตัะบะฐ .NET
dotnet --version

# ะัะพะฒะตัะบะฐ ัะฐะนะปะพะฒ
Test-Path "C:\SECS\Server\Server.csproj"
Test-Path "C:\SECS\Server\master-watchdog.ps1"
```

### ะัะพะฑะปะตะผะฐ: ะกะตัะฒะตั ะฝะต ะพัะฒะตัะฐะตั

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต ะธะฝัะตัะฝะตั ัะพะตะดะธะฝะตะฝะธะต
2. ะฃะฑะตะดะธัะตัั, ััะพ ะฟะพััั ะฝะต ะทะฐะฑะปะพะบะธัะพะฒะฐะฝั
3. ะัะพะฒะตัััะต ัะตััะธัะธะบะฐัั SSL
4. ะะตัะตะทะฐะฟัััะธัะต ัะธััะตะผั

```powershell
# ะขะตัั ัะพะตะดะธะฝะตะฝะธั
Test-NetConnection -ComputerName renderfin.com -Port 443

# ะะตัะตะทะฐะฟััะบ
Stop-ScheduledTask -TaskName "RenderFin-Server-Watchdog"
Start-ScheduledTask -TaskName "RenderFin-Server-Watchdog"
```

### ะัะพะฑะปะตะผะฐ: ะะฝะพะณะพ ะฟะตัะตะทะฐะฟััะบะพะฒ

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต ััะฐะฑะธะปัะฝะพััั ัะธััะตะผั
2. ะฃะฒะตะปะธัััะต `RestartCooldown`
3. ะัะพะฒะตัััะต ะปะพะณะธ ะฝะฐ ะพัะธะฑะบะธ
4. ะะฐััะผะพััะธัะต ะฐะฟะฟะฐัะฐัะฝัะต ะฟัะพะฑะปะตะผั

```powershell
# ะะฝะฐะปะธะท ะปะพะณะพะฒ
Get-Content C:\SECS\Code\master-watchdog.log | Select-String "ERROR"
Get-Content C:\SECS\Code\watchdog.log | Select-String "ERROR"
```

---

## ะะตะทะพะฟะฐัะฝะพััั

### ะัะฐะฒะฐ ะดะพัััะฟะฐ

- **ะะฐะดะฐัะฐ Windows**: ะะฐะฟััะบะฐะตััั ะพั ะธะผะตะฝะธ SYSTEM
- **ะคะฐะนะปั**: ะะพัััะฟ ัะพะปัะบะพ ะดะปั ะฐะดะผะธะฝะธัััะฐัะพัะพะฒ
- **ะะพะณะธ**: ะะฐัะธัะตะฝั ะพั ะธะทะผะตะฝะตะฝะธั ะพะฑััะฝัะผะธ ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ

### ะกะตัะตะฒะฐั ะฑะตะทะพะฟะฐัะฝะพััั

- **HTTPS**: ะัะต ะฟัะพะฒะตัะบะธ ัะตัะตะท ะทะฐัะธัะตะฝะฝะพะต ัะพะตะดะธะฝะตะฝะธะต
- **ะกะตััะธัะธะบะฐัั**: ะะฐะปะธะดะฐัะธั SSL ัะตััะธัะธะบะฐัะพะฒ
- **ะขะฐะนะผะฐััั**: ะะณัะฐะฝะธัะตะฝะธะต ะฒัะตะผะตะฝะธ ะทะฐะฟัะพัะพะฒ

### ะะตะบะพะผะตะฝะดะฐัะธะธ

1. ะะตะณัะปััะฝะพ ะฟัะพะฒะตััะนัะต ะปะพะณะธ
2. ะะฑะฝะพะฒะปัะนัะต .NET ะธ PowerShell
3. ะะพะฝะธัะพัััะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ัะตััััะพะฒ
4. ะะตะปะฐะนัะต ัะตะทะตัะฒะฝัะต ะบะพะฟะธะธ ะบะพะฝัะธะณััะฐัะธะธ

---

## ะะฐััะธัะตะฝะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

### ะะฐััะพะผะฝะฐั ะบะพะฝัะธะณััะฐัะธั

ะกะพะทะดะฐะนัะต ัะฐะนะป `watchdog-config.json`:

```json
{
  "ServerPath": "C:\\SECS\\Server",
  "CheckInterval": 30,
  "MaxRestarts": 15,
  "RestartCooldown": 300,
  "HealthCheckUrl": "https://renderfin.com/api-game-queue/stats",
  "MonitorFiles": true,
  "LogLevel": "INFO"
}
```

### ะะฝัะตะณัะฐัะธั ั ะผะพะฝะธัะพัะธะฝะณะพะผ

```powershell
# ะญะบัะฟะพัั ะผะตััะธะบ ะดะปั ะผะพะฝะธัะพัะธะฝะณะฐ
function Export-WatchdogMetrics {
    $task = Get-ScheduledTask -TaskName "RenderFin-Server-Watchdog"
    $taskInfo = Get-ScheduledTaskInfo -TaskName "RenderFin-Server-Watchdog"
    
    @{
        TaskState = $task.State
        LastRunTime = $taskInfo.LastRunTime
        LastResult = $taskInfo.LastTaskResult
        NextRunTime = $taskInfo.NextRunTime
    } | ConvertTo-Json
}
```

---

## FAQ

**Q: ะะพะถะฝะพ ะปะธ ะธะทะผะตะฝะธัั URL ะดะปั ะฟัะพะฒะตัะบะธ ะทะดะพัะพะฒัั?**
A: ะะฐ, ะพััะตะดะฐะบัะธััะนัะต ะฟะตัะตะผะตะฝะฝัั ะฒ ัะบัะธะฟัะฐั ะธะปะธ ัะพะทะดะฐะนัะต ะบะพะฝัะธะณััะฐัะธะพะฝะฝัะน ัะฐะนะป.

**Q: ะะฐะบ ัะฒะตะปะธัะธัั ะธะฝัะตัะฒะฐะป ะฟัะพะฒะตัะบะธ?**
A: ะัะฟะพะปัะทัะนัะต ะฟะฐัะฐะผะตัั `-CheckInterval` ะฟัะธ ะทะฐะฟััะบะต ะธะปะธ ะธะทะผะตะฝะธัะต ะทะฝะฐัะตะฝะธะต ะฟะพ ัะผะพะปัะฐะฝะธั.

**Q: ะงัะพ ะดะตะปะฐัั, ะตัะปะธ ัะธััะตะผะฐ ะฟะพััะตะฑะปัะตั ะผะฝะพะณะพ ัะตััััะพะฒ?**
A: ะฃะฒะตะปะธัััะต ะธะฝัะตัะฒะฐะปั ะฟัะพะฒะตัะบะธ ะธ ะพัะบะปััะธัะต ะผะพะฝะธัะพัะธะฝะณ ัะฐะนะปะพะฒ ะตัะปะธ ะพะฝ ะฝะต ะฝัะถะตะฝ.

**Q: ะะพะถะฝะพ ะปะธ ะทะฐะฟัััะธัั ะฝะตัะบะพะปัะบะพ ัะตัะฒะตัะพะฒ?**
A: ะะฐ, ะฝะพ ะฟะพััะตะฑัะตััั ะผะพะดะธัะธะบะฐัะธั ัะบัะธะฟัะพะฒ ะดะปั ัะฐะทะฝัั ะฟััะตะน ะธ ะฟะพััะพะฒ.

**Q: ะะฐะบ ะดะพะฑะฐะฒะธัั ัะฒะตะดะพะผะปะตะฝะธั?**
A: ะะพะถะตัะต ะดะพะฑะฐะฒะธัั ะพัะฟัะฐะฒะบั email ะธะปะธ push-ัะฒะตะดะพะผะปะตะฝะธะน ะฒ ััะฝะบัะธะธ ะปะพะณะธัะพะฒะฐะฝะธั.

---

## ะะพะดะดะตัะถะบะฐ

ะัะปะธ ั ะฒะฐั ะฒะพะทะฝะธะบะปะธ ะฟัะพะฑะปะตะผั:

1. ะัะพะฒะตัััะต ะปะพะณะธ ะฒ `C:\SECS\Code\`
2. ะัะฟะพะปัะทัะนัะต `control-system.bat` ะดะปั ะดะธะฐะณะฝะพััะธะบะธ
3. ะะฐะฟัััะธัะต ัะตัั ัะตัะฒะตัะฐ ัะตัะตะท ะผะตะฝั
4. ะัะพะฒะตัััะต ะฟัะฐะฒะฐ ะดะพัััะฟะฐ ะธ ัะธััะตะผะฝัะต ััะตะฑะพะฒะฐะฝะธั

**ะฃะดะฐัะฝะพะน ัะฐะฑะพัั ั RenderFin Server! ๐** 